<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
</head>
<body>
	<table class="table table-sm table-striped table-bordered sprintTable">
		
	</table>
<script src="xlsx.full.min.js"></script>
<script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
<script>
	// /* set up XMLHttpRequest */
	// var url = "libro2.xlsx";
	// var oReq = new XMLHttpRequest();
	// oReq.open("GET", url, true);
	// oReq.responseType = "arraybuffer";
	// var myData;

	// oReq.onload = function(e) {
	//   var arraybuffer = oReq.response;

	//   /* convert data to binary string */
	//   var data = new Uint8Array(arraybuffer);
	//   var arr = new Array();
	//   for(var i = 0; i != data.length; ++i) arr[i] = String.fromCharCode(data[i]);
	//   var bstr = arr.join("");

	//   /* Call XLSX */
	//   var workbook = XLSX.read(bstr, {type:"binary"});

	//   /* DO SOMETHING WITH workbook HERE */
	//   var first_sheet_name = workbook.SheetNames[0];
	//   /* Get worksheet */
	//   var worksheet = workbook.Sheets[first_sheet_name];
	//   myData = XLSX.utils.sheet_to_json(worksheet,{raw:true})
	// }

	// oReq.send();
	// var report;
	// setTimeout(function(){ report=myData.length; 
	// console.log(report);
	// slots = report *4;
	// for (n=0; n<slots; n++){
	// 	j = n+1;
	// 	$('body').append('<span class="row-'+j+'"></span>');
	// }
	// divIndex = 0;
	// for (i=0; i<report; i++){
 //    	$('span:eq('+divIndex+')').html(myData[i].Team);
	// 		divIndex++;
	//     $('span:eq('+divIndex+')').html(myData[i].Projects);
	// 		divIndex++;
	//     $('span:eq('+divIndex+')').html(myData[i].Done);
	// 		divIndex++;
	//     $('span:eq('+divIndex+')').html(myData[i].Estimated + "<br>");
	// 		divIndex++;
	// }}, 3000);

	/* set up XMLHttpRequest */
	var url = "libro2.xlsx";
	var oReq = new XMLHttpRequest();
	oReq.open("GET", url, true);
	oReq.responseType = "arraybuffer";
	//var myData;

	oReq.onload = function(e) {
	  var arraybuffer = oReq.response;

	  /* convert data to binary string */
	  var data = new Uint8Array(arraybuffer);
	  var arr = new Array();
	  for(var i = 0; i != data.length; ++i) arr[i] = String.fromCharCode(data[i]);
	  var bstr = arr.join("");

	  /* Call XLSX */
	  var workbook = XLSX.read(bstr, {type:"binary"});

	  /* DO SOMETHING WITH workbook HERE */
	  var first_sheet_name = workbook.SheetNames[0];
	  /* Get worksheet */
	  var worksheet = workbook.Sheets[first_sheet_name];
	  myData = XLSX.utils.sheet_to_json(worksheet,{raw:true})
		var report=myData.length; 
		console.log(report);
		slots = report *4;
		for (n=0; n<slots; n++){
			j = n+1;
			$('.sprintTable').append('<span class="badge badge-secondary row-'+j+'"></span>');
		}
		divIndex = 0;
		for (i=0; i<report; i++){
	    	$('span:eq('+divIndex+')').html(myData[i].Team);
				divIndex++;
		    $('span:eq('+divIndex+')').html(myData[i].Projects);
				divIndex++;
		    $('span:eq('+divIndex+')').html(myData[i].Done);
				divIndex++;
		    $('span:eq('+divIndex+')').html(myData[i].Estimated + "<br>");
				divIndex++;
		}}

	oReq.send();
</script>
</html>